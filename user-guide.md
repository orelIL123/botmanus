# מדריך שימוש - מערכת אוטומציה לוואטסאפ

## תוכן עניינים
1. [מבוא](#מבוא)
2. [התקנה ופריסה](#התקנה-ופריסה)
3. [ניהול לקוחות](#ניהול-לקוחות)
4. [תסריטי שיחה](#תסריטי-שיחה)
5. [הטמעה באתרי אינטרנט](#הטמעה-באתרי-אינטרנט)
6. [מעקב אחר לידים](#מעקב-אחר-לידים)
7. [התראות אימייל](#התראות-אימייל)
8. [לוח בקרה למנהל](#לוח-בקרה-למנהל)
9. [פתרון בעיות נפוצות](#פתרון-בעיות-נפוצות)

## מבוא

מערכת האוטומציה לוואטסאפ מאפשרת לך ליצור בוטים מותאמים אישית לוואטסאפ עבור לקוחות שונים. המערכת כוללת:

- **בק-אנד בפיירבייס** - מאחסן את נתוני הלקוחות, תסריטי השיחה והלידים
- **וידג'ט לאתרי אינטרנט** - מאפשר ללקוחות להטמיע את הבוט באתר שלהם
- **מערכת מעקב לידים** - מאפשרת לעקוב אחר לידים שנאספים מהבוט
- **התראות אימייל** - שולחת התראות בזמן אמת ללקוחות כאשר מתקבל ליד חדש
- **לוח בקרה למנהל** - מאפשר לנהל לקוחות, תסריטי שיחה ולידים

## התקנה ופריסה

### דרישות מקדימות

- חשבון Firebase
- Node.js (גרסה 16 ומעלה)
- Firebase CLI

### שלבי התקנה

1. **הורדת הפרויקט**
   ```bash
   git clone https://github.com/orelIL123/botmanus.git
   cd botmanus
   ```

2. **התקנת תלויות**
   ```bash
   cd functions
   npm install
   cd ..
   ```

3. **פריסה לפיירבייס**
   ```bash
   chmod +x deploy.sh
   ./deploy.sh
   ```
   
   הסקריפט יבצע את הפעולות הבאות:
   - התחברות לחשבון Firebase
   - אתחול הפרויקט (אם צריך)
   - התקנת תלויות
   - בניית הפרויקט
   - פריסה לפיירבייס

4. **בדיקת המערכת**
   ```bash
   chmod +x test.sh
   ./test.sh
   ```
   
   הסקריפט יבדוק את כל רכיבי המערכת ויוודא שהם פועלים כראוי.

## ניהול לקוחות

### יצירת לקוח חדש

1. היכנס ללוח הבקרה למנהל בכתובת: `https://whatsapp-bot-automation.web.app/admin-dashboard.html`
2. לחץ על "לקוחות" בתפריט הצד
3. לחץ על "הוסף לקוח חדש"
4. מלא את הפרטים הבאים:
   - **שם העסק**: שם העסק של הלקוח
   - **מספר וואטסאפ**: מספר הטלפון של העסק בפורמט בינלאומי (לדוגמה: 972501234567)
   - **אימייל**: כתובת האימייל לקבלת התראות על לידים חדשים
   - **הודעת פתיחה**: ההודעה שתוצג ללקוחות בתחילת השיחה
5. לחץ על "שמור"

### עריכת לקוח קיים

1. היכנס ללוח הבקרה למנהל
2. לחץ על "לקוחות" בתפריט הצד
3. מצא את הלקוח שברצונך לערוך ולחץ על "ערוך"
4. עדכן את הפרטים הרצויים
5. לחץ על "שמור"

### מחיקת לקוח

1. היכנס ללוח הבקרה למנהל
2. לחץ על "לקוחות" בתפריט הצד
3. מצא את הלקוח שברצונך למחוק ולחץ על "מחק"
4. אשר את המחיקה

## תסריטי שיחה

תסריטי שיחה מגדירים את מהלך השיחה בין הבוט ללקוח. כל תסריט מורכב מצעדים (steps) שמגדירים את התנהגות הבוט.

### סוגי צעדים

- **message**: הצגת הודעה ללקוח
- **options**: הצגת אפשרויות בחירה ללקוח
- **collect_info**: איסוף מידע מהלקוח (שם, טלפון וכו')
- **end**: סיום השיחה

### יצירת תסריט שיחה חדש

1. היכנס ללוח הבקרה למנהל
2. לחץ על "תסריטי שיחה" בתפריט הצד
3. בחר לקוח מהרשימה הנפתחת
4. לחץ על "הוסף תסריט חדש"
5. מלא את הפרטים הבאים:
   - **שם התסריט**: שם ייחודי לתסריט
   - **מזהה התסריט**: מזהה ייחודי לתסריט (ללא רווחים או תווים מיוחדים)
6. הוסף צעדים לתסריט:
   - לחץ על "הוסף צעד"
   - בחר את סוג הצעד
   - מלא את הפרטים הנדרשים
   - הגדר את הצעד הבא בתסריט
7. לחץ על "שמור"

### עריכת תסריט קיים

1. היכנס ללוח הבקרה למנהל
2. לחץ על "תסריטי שיחה" בתפריט הצד
3. בחר לקוח מהרשימה הנפתחת
4. מצא את התסריט שברצונך לערוך ולחץ על "ערוך"
5. עדכן את הפרטים הרצויים
6. לחץ על "שמור"

### דוגמה לתסריט שיחה

להלן דוגמה לתסריט שיחה בפורמט JSON:

```json
{
  "flowId": "new_collection",
  "name": "מידע על הקולקציה החדשה",
  "steps": [
    {
      "id": "collect_info",
      "type": "collect_info",
      "message": "נשמח לספר לך על הקולקציה החדשה שלנו! כדי שנוכל לעדכן אותך בפריטים שמתאימים בדיוק לך, אנא ספר/י לנו קצת על עצמך:",
      "fields": [
        {
          "id": "name",
          "type": "text",
          "label": "שם מלא",
          "required": true
        },
        {
          "id": "phone",
          "type": "phone",
          "label": "מספר טלפון",
          "required": true
        }
      ],
      "next": "collection_preferences"
    },
    {
      "id": "collection_preferences",
      "type": "options",
      "message": "תודה {{name}}! באיזה סוג פריטים מהקולקציה החדשה את/ה מתעניין/ת?",
      "options": [
        {
          "id": "mens",
          "text": "בגדי גברים",
          "next": "mens_info"
        },
        {
          "id": "womens",
          "text": "בגדי נשים",
          "next": "womens_info"
        }
      ]
    },
    {
      "id": "mens_info",
      "type": "message",
      "message": "הקולקציה החדשה לגברים שלנו כוללת חולצות מעוצבות ומכנסיים אלגנטיים.",
      "next": "end"
    },
    {
      "id": "womens_info",
      "type": "message",
      "message": "הקולקציה החדשה לנשים שלנו כוללת שמלות מעוצבות וחולצות אופנתיות.",
      "next": "end"
    },
    {
      "id": "end",
      "type": "end",
      "message": "תודה שהתעניינת בקולקציה החדשה שלנו!"
    }
  ]
}
```

## הטמעה באתרי אינטרנט

### שיטת התקנה בסיסית

הוסף את הקוד הבא לדף ה-HTML של האתר, ממש לפני תג הסגירה של ה-body:

```html
<script src="https://us-central1-whatsapp-bot-automation.cloudfunctions.net/app/js/whatsapp-bot-widget.js" 
        data-whatsapp-bot-client="YOUR_CLIENT_ID" 
        data-whatsapp-bot-api="https://us-central1-whatsapp-bot-automation.cloudfunctions.net"></script>
```

החלף את `YOUR_CLIENT_ID` במזהה הלקוח שקיבלת בעת יצירת הלקוח.

### התאמה אישית

ניתן להתאים את מראה הכפתור ואת התנהגותו באמצעות קוד JavaScript נוסף:

```html
<script>
    document.addEventListener('DOMContentLoaded', function() {
        WhatsAppBotWidget.init({
            clientId: 'YOUR_CLIENT_ID',
            apiUrl: 'https://us-central1-whatsapp-bot-automation.cloudfunctions.net',
            buttonPosition: 'right', // 'right' או 'left'
            buttonColor: '#25D366', // צבע הכפתור
            buttonSize: '60px', // גודל הכפתור
            buttonRadius: '50%', // עיגול הכפתור
            buttonMargin: '20px', // מרחק מהקצה
            buttonText: 'צור קשר', // טקסט שיוצג ליד הכפתור
            showButtonText: true // האם להציג טקסט ליד הכפתור
        });
    });
</script>
```

### שילוב בפלטפורמות נפוצות

#### WordPress

**שיטה 1: שימוש בתוסף Header and Footer Scripts**
1. התקן את התוסף "Header and Footer Scripts"
2. לך להגדרות התוסף
3. הוסף את קוד ההטמעה לחלק ה-Footer
4. שמור את השינויים

**שיטה 2: עריכת קובץ התבנית**
1. לך ל-Appearance > Theme Editor
2. ערוך את קובץ footer.php
3. הוסף את קוד ההטמעה לפני תג הסגירה של ה-body
4. שמור את השינויים

#### Wix

1. היכנס לעורך האתר של Wix
2. לחץ על "הוסף" בתפריט הצד
3. בחר "HTML מותאם אישית"
4. הוסף את קוד ההטמעה
5. לחץ על "החל"
6. מקם את האלמנט בתחתית הדף (הוא יהיה בלתי נראה, אך הכפתור יופיע)
7. הגדר את האלמנט להופיע בכל הדפים

#### Shopify

1. היכנס ללוח הבקרה של Shopify
2. לך ל-Online Store > Themes
3. לחץ על "Actions" ובחר "Edit code"
4. חפש את הקובץ theme.liquid
5. הוסף את קוד ההטמעה לפני תג הסגירה של ה-body
6. לחץ על "Save"

## מעקב אחר לידים

### צפייה בלידים

1. היכנס ללוח הבקרה למנהל
2. לחץ על "לידים" בתפריט הצד
3. בחר לקוח מהרשימה הנפתחת (או השאר "כל הלקוחות" לצפייה בכל הלידים)
4. הלידים יוצגו בטבלה עם הפרטים הבאים:
   - שם
   - טלפון
   - לקוח
   - תסריט שיחה
   - תאריך
   - פעולות

### סינון לידים

ניתן לסנן את הלידים לפי:
- לקוח
- תאריך
- תסריט שיחה

### ייצוא לידים

1. היכנס ללוח הבקרה למנהל
2. לחץ על "לידים" בתפריט הצד
3. בחר לקוח מהרשימה הנפתחת (אופציונלי)
4. לחץ על "ייצא לקובץ CSV"
5. הקובץ יורד למחשב שלך

## התראות אימייל

המערכת שולחת התראות אימייל ללקוחות כאשר מתקבל ליד חדש. ההתראה כוללת:
- שם הליד
- מספר טלפון
- תאריך ושעה
- תסריט השיחה המלא

### הגדרת אימייל

1. היכנס ללוח הבקרה למנהל
2. לחץ על "הגדרות" בתפריט הצד
3. מלא את הפרטים הבאים:
   - **כתובת אימייל לשליחת התראות**: כתובת האימייל ממנה יישלחו ההתראות
   - **סיסמת אימייל**: סיסמת האימייל (מומלץ להשתמש בסיסמה ייעודית לאפליקציות)
   - **שירות אימייל**: בחר את שירות האימייל (Gmail, Outlook, Yahoo וכו')
4. לחץ על "שמור הגדרות"

### בדיקת אימייל

1. היכנס ללוח הבקרה למנהל
2. לחץ על "הגדרות" בתפריט הצד
3. לחץ על "שלח אימייל בדיקה"
4. הזן את כתובת האימייל לבדיקה
5. לחץ על "שלח"

## לוח בקרה למנהל

לוח הבקרה למנהל מאפשר לך לנהל את כל היבטי המערכת:

### סקירה כללית

מציג סטטיסטיקות כלליות על המערכת:
- מספר לקוחות
- מספר לידים
- אחוז המרה ממוצע

### ניהול לקוחות

מאפשר לך לנהל את הלקוחות במערכת:
- יצירת לקוחות חדשים
- עריכת לקוחות קיימים
- מחיקת לקוחות

### ניהול לידים

מאפשר לך לצפות בלידים שנאספו מהבוט:
- צפייה בפרטי הלידים
- סינון לידים לפי לקוח, תאריך ותסריט שיחה
- ייצוא לידים לקובץ CSV

### ניהול תסריטי שיחה

מאפשר לך לנהל את תסריטי השיחה של הבוט:
- יצירת תסריטים חדשים
- עריכת תסריטים קיימים
- מחיקת תסריטים

### הגדרות

מאפשר לך לנהל את הגדרות המערכת:
- הגדרות אימייל
- הגדרות כלליות

## פתרון בעיות נפוצות

### הבוט לא מופיע באתר

1. ודא שהטמעת את הקוד הנכון באתר
2. ודא שמזהה הלקוח נכון
3. בדוק את קונסולת הפיתוח של הדפדפן לאיתור שגיאות
4. ודא שאין התנגשות עם סקריפטים אחרים באתר

### לא מתקבלות התראות אימייל

1. ודא שהגדרת את פרטי האימייל הנכונים בהגדרות
2. בדוק את תיקיית הספאם באימייל
3. ודא שהאימייל שהגדרת מאפשר שליחת אימיילים מאפליקציות
4. נסה לשלוח אימייל בדיקה דרך לוח הבקרה

### שגיאות בתסריט השיחה

1. ודא שכל הצעדים בתסריט מוגדרים כראוי
2. ודא שכל צעד מפנה לצעד הבא הנכון
3. בדוק שאין שגיאות תחביר ב-JSON של התסריט
4. בדוק את לוגי השגיאות בקונסולת Firebase

### בעיות בפריסה

1. ודא שיש לך הרשאות מתאימות בפרויקט Firebase
2. ודא שהתקנת את כל התלויות הנדרשות
3. בדוק את לוגי השגיאות בקונסולת Firebase
4. נסה להריץ את סקריפט הפריסה שוב

---

לשאלות נוספות או תמיכה טכנית, אנא צור קשר בכתובת: support@example.com
